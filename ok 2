<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Thiệp Cưới Online</title>
  <style>
    body { font-family: Arial, sans-serif; background: #fff0f5; margin: 0; padding: 0; }
    nav { background: #ffb6c1; padding: 10px; display: none; justify-content: space-around; position: sticky; top: 0; z-index: 10; }
    nav a { text-decoration: none; color: #333; font-weight: bold; }
    .section { padding: 20px; display: none; }
    .active { display: block; }
    .form-group { margin-bottom: 10px; }
    input, textarea { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
    button { padding: 10px 15px; border: none; border-radius: 5px; background-color: #ff69b4; color: white; cursor: pointer; }
    .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; }
    .product, .rental { border: 1px solid #ccc; padding: 10px; margin-top: 10px; border-radius: 6px; background: #fff; }
    img { max-width: 100px; border-radius: 6px; }
    .admin { display: none; }
  </style>
</head>
<body>

<nav id="main-nav">
  <a href="#" onclick="showSection('home-after-login')">🏠 Home</a>
  <a href="#" onclick="showSection('tao-thiep')">💌 Thiệp Cưới</a>
  <a href="#" onclick="showSection('mua-qua')">🎁 Mua Quà</a>
  <a href="#" onclick="showSection('thue-do')">🧥 Thuê Đồ</a>
  <a href="#" onclick="showSection('don-hang')">📦 Đơn Hàng</a>
</nav>

<div class="section active" id="login">
  <div class="card">
    <h2>Đăng nhập</h2>
    <input id="email" placeholder="Email">
    <input id="password" placeholder="Mật khẩu" type="password">
    <button onclick="login()">Đăng nhập</button>
    <hr>
    <input id="role" placeholder="Vai trò (admin hoặc khach)">
    <button onclick="register()">Đăng ký</button>
  </div>
</div>

<div class="section" id="home-after-login">
  <div class="card">
    <h2>Chào mừng!</h2>
    <p>Chọn chức năng từ menu trên.</p>
  </div>
</div>

<div class="section" id="tao-thiep">
  <div class="card">
    <h2>Tùy chọn giao diện thiệp cưới</h2>
    <select id="theme-select">
      <option value="classic">Cổ điển</option>
      <option value="modern">Hiện đại</option>
      <option value="floral">Hoa lá</option>
    </select>
    <textarea id="loi-chuc" placeholder="Lời chúc..." rows="4"></textarea>
    <div id="preview-thiep" style="margin-top: 10px; padding: 20px; border: 2px dashed #ff69b4;"></div>
    <button onclick="taoThiep()">Xem Thiệp</button>
  </div>
</div>

<div class="section" id="mua-qua">
  <div class="card admin">
    <h2>Thêm sản phẩm quà</h2>
    <input type="file" id="img-qua">
    <input id="ten-qua" placeholder="Tên">
    <input id="gia-qua" placeholder="Giá">
    <button onclick="themSanPham('qua')">Thêm</button>
  </div>
  <input oninput="timKiemSanPham('qua', this.value)" placeholder="Tìm kiếm quà...">
  <div id="list-qua"></div>
</div>

<div class="section" id="thue-do">
  <div class="card admin">
    <h2>Thêm đồ thuê</h2>
    <input type="file" id="img-thue">
    <input id="ten-thue" placeholder="Tên">
    <input id="gia-thue" placeholder="Giá">
    <button onclick="themSanPham('thue')">Thêm</button>
  </div>
  <input oninput="timKiemSanPham('thue', this.value)" placeholder="Tìm kiếm thuê...">
  <div id="list-thue"></div>
</div>

<div class="section" id="don-hang">
  <div class="card">
    <h2>Đơn Hàng</h2>
    <div id="list-donhang"></div>
  </div>
</div>

<script>
  let role = "khach";
  let products = JSON.parse(localStorage.getItem("products") || '{}');
  let donhangs = JSON.parse(localStorage.getItem("donhang") || '[]');

  function showSection(id) {
    document.querySelectorAll('.section').forEach(s => s.style.display = 'none');
    document.getElementById(id).style.display = 'block';
    if (id === 'mua-qua') hienThiSanPham('qua');
    if (id === 'thue-do') hienThiSanPham('thue');
    if (id === 'don-hang') hienThiDonHang();
  }

  function login() {
    role = document.getElementById('email').value.includes('admin') ? 'admin' : 'khach';
    document.getElementById('login').style.display = 'none';
    document.getElementById('main-nav').style.display = 'flex';
    document.querySelectorAll('.admin').forEach(e => e.style.display = role === 'admin' ? 'block' : 'none');
    showSection('home-after-login');
  }

  function register() {
    alert("Đăng ký thành công, bạn có thể đăng nhập");
  }

  function taoThiep() {
    const theme = document.getElementById('theme-select').value;
    const loiChuc = document.getElementById('loi-chuc').value;
    document.getElementById('preview-thiep').innerHTML = `<div><h3>Chủ đề: ${theme}</h3><p>${loiChuc}</p></div>`;
  }

  function themSanPham(loai) {
    const ten = document.getElementById(loai === 'qua' ? 'ten-qua' : 'ten-thue').value;
    const gia = document.getElementById(loai === 'qua' ? 'gia-qua' : 'gia-thue').value;
    const file = document.getElementById(loai === 'qua' ? 'img-qua' : 'img-thue').files[0];
    const reader = new FileReader();
    reader.onload = () => {
      if (!products[loai]) products[loai] = [];
      products[loai].push({ ten, gia, img: reader.result });
      localStorage.setItem('products', JSON.stringify(products));
      hienThiSanPham(loai);
    };
    reader.readAsDataURL(file);
  }

  function hienThiSanPham(loai) {
    const list = document.getElementById('list-' + loai);
    list.innerHTML = '';
    (products[loai] || []).forEach((sp, i) => {
      list.innerHTML += `
        <div class="${loai === 'qua' ? 'product' : 'rental'}">
          <img src="${sp.img}"><br>
          <b>${sp.ten}</b> - ${sp.gia} <br>
          <button onclick="muaSanPham('${loai}', ${i})">Mua</button>
          ${role === 'admin' ? `<button onclick="xoaSanPham('${loai}', ${i})">Xóa</button>` : ''}
        </div>
      `;
    });
  }

  function timKiemSanPham(loai, tuKhoa) {
    const list = document.getElementById('list-' + loai);
    list.innerHTML = '';
    (products[loai] || []).filter(sp => sp.ten.includes(tuKhoa)).forEach((sp, i) => {
      list.innerHTML += `
        <div class="${loai === 'qua' ? 'product' : 'rental'}">
          <img src="${sp.img}"><br>
          <b>${sp.ten}</b> - ${sp.gia} <br>
          <button onclick="muaSanPham('${loai}', ${i})">Mua</button>
          ${role === 'admin' ? `<button onclick="xoaSanPham('${loai}', ${i})">Xóa</button>` : ''}
        </div>
      `;
    });
  }

  function muaSanPham(loai, i) {
    const ten = prompt("Tên người nhận:");
    const diachi = prompt("Địa chỉ:");
    const sdt = prompt("SĐT:");
    const sp = products[loai][i];
    donhangs.push({ loai, tenSP: sp.ten, gia: sp.gia, ten, diachi, sdt });
    localStorage.setItem('donhang', JSON.stringify(donhangs));
    alert("Đã đặt hàng thành công! (Mô phỏng gửi email)");
  }

  function hienThiDonHang() {
    const box = document.getElementById('list-donhang');
    box.innerHTML = donhangs.map(d => `<div><b>${d.tenSP}</b> (${d.loai}) - ${d.gia} <br> ${d.ten}, ${d.sdt}, ${d.diachi}</div><hr>`).join('');
  }

  function xoaSanPham(loai, i) {
    products[loai].splice(i, 1);
    localStorage.setItem('products', JSON.stringify(products));
    hienThiSanPham(loai);
  }
</script>

</body>
</html>
